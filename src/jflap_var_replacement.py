# string to be converted to a CFG
cfg = """X	gui.grammar.ArrowIcon@36be1ba4	B(<)D(7)
X	gui.grammar.ArrowIcon@36be1ba4	B(<)D(10)
X	gui.grammar.ArrowIcon@36be1ba4	B(<)D(4)
X	gui.grammar.ArrowIcon@36be1ba4	B(<)D(2)
R	gui.grammar.ArrowIcon@36be1ba4	B( )D(8)
P	gui.grammar.ArrowIcon@36be1ba4	B( )D(1)
P	gui.grammar.ArrowIcon@36be1ba4	B( )D(9)
R	gui.grammar.ArrowIcon@36be1ba4	B( )D(3)
P	gui.grammar.ArrowIcon@36be1ba4	B( )D(5)
P	gui.grammar.ArrowIcon@36be1ba4	B( )D(6)
C	gui.grammar.ArrowIcon@36be1ba4	B(<)D(10)
D(10)	gui.grammar.ArrowIcon@36be1ba4	B(h)D(20)
D(20)	gui.grammar.ArrowIcon@36be1ba4	B(t)D(30)
D(30)	gui.grammar.ArrowIcon@36be1ba4	B(m)D(40)
D(40)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(47)
D(47)	gui.grammar.ArrowIcon@36be1ba4	B(>)D(49)
D(49)	gui.grammar.ArrowIcon@36be1ba4	B(<)D(50)
D(50)	gui.grammar.ArrowIcon@36be1ba4	B(/)D(51)
D(51)	gui.grammar.ArrowIcon@36be1ba4	B(h)D(52)
D(52)	gui.grammar.ArrowIcon@36be1ba4	B(t)D(53)
D(53)	gui.grammar.ArrowIcon@36be1ba4	B(m)D(54)
D(54)	gui.grammar.ArrowIcon@36be1ba4	B(l)B(>)
R	gui.grammar.ArrowIcon@36be1ba4	B( )D(9)
D(9)	gui.grammar.ArrowIcon@36be1ba4	B(i)D(19)
D(19)	gui.grammar.ArrowIcon@36be1ba4	B(d)D(29)
D(29)	gui.grammar.ArrowIcon@36be1ba4	B(=)D(39)
D(39)	gui.grammar.ArrowIcon@36be1ba4	B(")D(46)
D(46)	gui.grammar.ArrowIcon@36be1ba4	ZB(")
P	gui.grammar.ArrowIcon@36be1ba4	B( )D(8)
D(8)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(18)
D(18)	gui.grammar.ArrowIcon@36be1ba4	B(a)D(28)
D(28)	gui.grammar.ArrowIcon@36be1ba4	TD(38)
D(38)	gui.grammar.ArrowIcon@36be1ba4	B(g)D(29)
C	gui.grammar.ArrowIcon@36be1ba4	B(<)D(7)
D(7)	gui.grammar.ArrowIcon@36be1ba4	B(h)D(17)
D(17)	gui.grammar.ArrowIcon@36be1ba4	B(t)D(27)
D(27)	gui.grammar.ArrowIcon@36be1ba4	B(m)D(37)
D(37)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(45)
D(45)	gui.grammar.ArrowIcon@36be1ba4	B(>)D(48)
D(48)	gui.grammar.ArrowIcon@36be1ba4	CD(49)
R	gui.grammar.ArrowIcon@36be1ba4	B( )D(6)
D(6)	gui.grammar.ArrowIcon@36be1ba4	B(i)D(16)
D(16)	gui.grammar.ArrowIcon@36be1ba4	B(d)D(26)
D(26)	gui.grammar.ArrowIcon@36be1ba4	B(=)D(36)
D(36)	gui.grammar.ArrowIcon@36be1ba4	B(")B(")
B(i)	gui.grammar.ArrowIcon@36be1ba4	i
B(d)	gui.grammar.ArrowIcon@36be1ba4	d
R	gui.grammar.ArrowIcon@36be1ba4	B( )D(5)
D(5)	gui.grammar.ArrowIcon@36be1ba4	B(c)D(15)
D(15)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(25)
D(25)	gui.grammar.ArrowIcon@36be1ba4	B(a)D(35)
D(35)	gui.grammar.ArrowIcon@36be1ba4	B(s)D(44)
D(44)	gui.grammar.ArrowIcon@36be1ba4	B(s)D(26)
C	gui.grammar.ArrowIcon@36be1ba4	B(<)D(4)
D(4)	gui.grammar.ArrowIcon@36be1ba4	B(h)D(14)
D(14)	gui.grammar.ArrowIcon@36be1ba4	B(t)D(24)
D(24)	gui.grammar.ArrowIcon@36be1ba4	B(m)D(34)
D(34)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(43)
D(43)	gui.grammar.ArrowIcon@36be1ba4	RD(47)
P	gui.grammar.ArrowIcon@36be1ba4	B( )D(3)
D(3)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(13)
D(13)	gui.grammar.ArrowIcon@36be1ba4	B(a)D(23)
D(23)	gui.grammar.ArrowIcon@36be1ba4	TD(33)
D(33)	gui.grammar.ArrowIcon@36be1ba4	B(g)D(26)
B(g)	gui.grammar.ArrowIcon@36be1ba4	g
C	gui.grammar.ArrowIcon@36be1ba4	B(<)D(2)
D(2)	gui.grammar.ArrowIcon@36be1ba4	B(h)D(12)
D(12)	gui.grammar.ArrowIcon@36be1ba4	B(t)D(22)
D(22)	gui.grammar.ArrowIcon@36be1ba4	B(m)D(32)
D(32)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(42)
D(42)	gui.grammar.ArrowIcon@36be1ba4	RD(45)
B(<)	gui.grammar.ArrowIcon@36be1ba4	<
B(h)	gui.grammar.ArrowIcon@36be1ba4	h
B(t)	gui.grammar.ArrowIcon@36be1ba4	t
B(m)	gui.grammar.ArrowIcon@36be1ba4	m
B(>)	gui.grammar.ArrowIcon@36be1ba4	>
B(/)	gui.grammar.ArrowIcon@36be1ba4	/
R	gui.grammar.ArrowIcon@36be1ba4	B( )D(1)
D(1)	gui.grammar.ArrowIcon@36be1ba4	B(c)D(11)
D(11)	gui.grammar.ArrowIcon@36be1ba4	B(l)D(21)
D(21)	gui.grammar.ArrowIcon@36be1ba4	B(a)D(31)
D(31)	gui.grammar.ArrowIcon@36be1ba4	B(s)D(41)
D(41)	gui.grammar.ArrowIcon@36be1ba4	B(s)D(29)
B( )	gui.grammar.ArrowIcon@36be1ba4	 
B(c)	gui.grammar.ArrowIcon@36be1ba4	c
B(l)	gui.grammar.ArrowIcon@36be1ba4	l
B(a)	gui.grammar.ArrowIcon@36be1ba4	a
B(s)	gui.grammar.ArrowIcon@36be1ba4	s
B(=)	gui.grammar.ArrowIcon@36be1ba4	=
B(")	gui.grammar.ArrowIcon@36be1ba4	"
P	gui.grammar.ArrowIcon@36be1ba4	RP
C	gui.grammar.ArrowIcon@36be1ba4	TZ
R	gui.grammar.ArrowIcon@36be1ba4	RP
T	gui.grammar.ArrowIcon@36be1ba4	n
Z	gui.grammar.ArrowIcon@36be1ba4	TZ
Z	gui.grammar.ArrowIcon@36be1ba4	n
C	gui.grammar.ArrowIcon@36be1ba4	n
"""

import re

# Function to generate unique non-terminals
def generate_unique_nonterminals(cfg):
    non_terminals = set(re.findall(r'[A-Z]\(.*?\)', cfg))
    non_terminal_mapping = {}
    for i, non_terminal in enumerate(non_terminals):
        # Generating two-letter non-terminals, upper or lower case
        new_non_terminal = chr(65 + i % 26) + chr(97 + (i // 26) % 26)
        non_terminal_mapping[non_terminal] = new_non_terminal
    return non_terminal_mapping

# Function to convert the string to a CFG
def convert_to_cfg(cfg):
    # Split the string by newlines
    cfg = cfg.split('\n')
    # Get rid of empty strings
    cfg = [line for line in cfg if line]
    # get rid of gui.grammar.ArrowIcon@36be1ba4
    cfg = [line.split('\t') for line in cfg]
    # change element 1 of each line to '->'
    for line in cfg:
        line[1] = '->'
        
    # Convert back to a string
    cfg = [' '.join(line) for line in cfg]
    # Join the lines with '\n'
    cfg = '\n'.join(cfg)
    # Iterate over each line in the CFG, and change elements in format 'B(<)' to a unique non-terminal
    # Generate mapping of old non-terminals to new non-terminals
    non_terminal_mapping = generate_unique_nonterminals(cfg)

    # Replace old non-terminals with new non-terminals in the CFG
    for old_non_terminal, new_non_terminal in non_terminal_mapping.items():
        cfg = cfg.replace(old_non_terminal, new_non_terminal)
        

    return cfg

print(convert_to_cfg(cfg))

# Save the CFG to a file
with open('grammar.txt', 'w') as f:
    f.write(convert_to_cfg(cfg))


